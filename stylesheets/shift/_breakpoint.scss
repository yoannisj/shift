// =============================================================================
// =SHIFT - BREAKPOINT
// =============================================================================

@import "shift/config";
@import "shift/parse";
@import "shift/query";
@import "shift/context";

// =shift-breakpoint( $params[, $tweakpoint, $units ])
// -----------------------------------------------------------------------------
/// Wraps content into a breakpoint media-query and outputs it only if current
/// stylesheet should contain media-queries.
/// **Note**: If the `$shift-include-mq` global is set to `false`, content will
/// not be output, unless the `$shift-no-mq-fallback` global is set to true and
/// the given expression is in range with the `$shift-no-mq-min-width` global.
/// This makes it possible to generate a stylesheet targeted at legacy browsers
/// that dont support media-queries.
/// @link http://jakearchibald.github.io/sass-ie/
///
/// @param {string|map} $params - A shift expression or a map of media-query parameters
/// @param {string} $tweakpoint - An optional tweakpoint to get values from
/// @param {map} $units - The units to use for media-query feature
///
/// @content Css rules that should be applied for the given breakpoint query.
///
/// @example scss
///   Example Code
///
/// @access public
/// @since 0.10
///
/// @todo Description

@mixin shift-breakpoint( $params, $tweakpoint: null, $units: () )
{
  // get all params and replace labels with values
  $params: shift-parse($params, $tweakpoint);

  // save current context, so it can be restored later on
  @include shift-context-save();
  // store @media params into context
  @include shift-context($params);
  @include shift-context('tweakpoint', $tweakpoint);

  // include content if stylesheet should contain media-queries
  // (aimed at browsers)
  @if $shift-include-mq
  {
    // output media-query based on given parameters
    @media #{shift-query($params, $tweakpoint, $units)}
    {
      @content;
    }
  }

  // include content *at-root* in media-query-free stylesheets
  // (aimed at browsers not supporting media-queries)
  @else if $shift-include-fallback
  {
    $min-width: map-get($params, 'min-width');
    $max-width: map-get($params, 'max-width');

    @if ($min-width == null or $min-width <= $shift-fallback-min-width) and
      ($max-width == null or $max-width >= $shift-fallback-min-width)
    {
      @content;
    }
  }

  // restore context as it was, outside of breakpoint @media block
  @include shift-context-restore();
}

// =shift( $params[, $tweakpoint, $units ])
// -----------------------------------------------------------------------------
/// @alias shift-breakpoint

@mixin shift( $params, $tweakpoint: null, $units: ()) {
  @include shift-breakpoint($params, $tweakpoint, $units) {
    @content;
  }
}